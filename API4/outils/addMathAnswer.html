<div statu="non-modifiable" class="unselectable dvScience savable dvFocused construction" type="scientifique" id="boiteindice" style="width: 377px; height: 243px; z-index: 20; right: auto; bottom: auto; font-size: 14px; position: absolute; top: 91px; left: 76px;">
    <div style="position: absolute; width: 100%;"> <img style="display: block;" title="Liste des commandes" src="https://coursdesciences.fr/devoirTest/noENT/API4/img/aide.png" class="aide"><img style="display: block;" title="initialiser ou réinitialiser l\'interactivité" src="https://coursdesciences.fr/devoirTest/noENT/API4/img/refresh.png" class="refresh"><img title="ajouter une ligne au début" src="https://coursdesciences.fr/devoirTest/noENT/API4/img/newLine.png" class="firstAdd" style="display: block;"></div>
    <div id="dvMathindice" style="position: absolute; overflow: auto; width: 100%; max-height: 95%; margin-top: 10px;"><span style="font-size: 0px;"></span></div>
    <input id="scienceindice" style="display: none;" type="text">
    <script class="scriptScience">
    $("#boiteindice .refresh").on("click", function(evt) {
    	evt.stopPropagation();
        $("#boiteindice").trigger("refresh");
    });
    $("#boiteindice").on("click", ".firstAdd", function(evt) {
                evt.stopPropagation();
                var html = \'<span class="dvMq new"  style="display: block; border: medium none;" latex=""></span><img class="supp" src="' + site + API + '/img/smallSupp.png" title="Supprimer la ligne">\'; $("#dvMathindice").prepend(html); $("#dvMathindice .new").trigger("newDvMq"); $("#dvMathindice .new").find("textarea").trigger("focus"); $("#dvMathindice .new").removeClass("new"); }); $("#scienceindice").on("change", function(evt) { $("#boiteindice").trigger("change"); }); $("#boiteindice").on("save", function(evt) { var txt = encodeURI($("#dvMathindice").html()); $("#scienceindice").val(txt); }); $("#boiteindice").on("change", function(evt) { var etat=$(this).parent(".question").css("display");$(this).parent(".question").show(); if ($("#boiteindice").attr("statu") == "modifiable") { $("#dvMathindice").html(decodeURI($("#scienceindice").val())); }$("#boiteindice").trigger("refresh"); $(this).parent(".question").css("display",etat); }); $("#boiteindice").on("refresh", function(evt) { $("#boiteindice .supp,#boiteindice .firstAdd,#boiteindice .aide,#boiteindice .refresh").hide(); $("#dvMathindice .dvMq").each(function() { $(this).attr("class", "dvMq").text($(this).attr("latex")); if ((statu == "eleve" && !revoirDs && $("#boiteindice").attr("statu") == "modifiable") || (statu == "prof" && dv.modeEbauche && $("#boiteindice").attr("statu") != "modifiable")) { MQ.MathField(this) } else { MQ.StaticMath(this) } }); if ((statu == "eleve" && !revoirDs && $("#boiteindice").attr("statu") == "modifiable") || (statu == "prof" && dv.modeEbauche && $("#boiteindice").attr("statu") != "modifiable")) { $("#boiteindice .supp,#boiteindice .firstAdd,#boiteindice .aide,#boiteindice .refresh").show(); $("#dvMathindice").off("newDvMq mousedown blur lostFocus focus click mouseenter mouseleave keyup"); $("#dvMathindice").on("newDvMq", ".dvMq", function(evt) { MQ.MathField(this) }); $("#dvMathindice").on("mousedown click", ".dvMq", function(evt) { evt.stopPropagation(); }); $("#dvMathindice").on("blur", ".dvMq textarea", function(evt) { $(this).parent().parent().parent().trigger("lostFocus") }); $("#dvMathindice").on("lostFocus", function(evt) { if ($("#dvMathindice .mq-focused").length == 0) { $("#dvMathindice").addClass("dvFocused"); } else { $("#dvMathindice").removeClass("dvFocused"); $("#dvMathindice .dvMq").each(function() { $(this).attr("latex", MQ.MathField(this).latex()) }); } }); $("#dvMathindice").on("focus", ".dvMq textarea", function(evt) { $(this).parent().parent().parent().trigger("hasFocus") }); $("#dvMathindice").on("hasFocus", function(evt) { $("#boiteindice").addClass("dvFocused"); }); $("#dvMathindice").on("click", ".supp", function(evt) { $(this).prev().remove(); $(this).remove(); }); $("#dvMathindice").on("mouseenter", ".supp", function(evt) { $(this).prev().css("background-color", "rgb(221, 142, 136)") }); $("#dvMathindice").on("mouseleave", ".supp", function(evt) { $(this).prev().css("background-color", "") }); $("#dvMathindice").on("keyup", ".dvMq", function(event) { event.stopPropagation(); if (event.which == 13) { var html = \'<span class="dvMq"  style="display: block; border: medium none;" latex=""></span><img class="supp" src="' + site + API + '/img/smallSupp.png" title="Supprimer la ligne">\'; $(this).next().after(html); $(this).next().next().trigger("newDvMq"); $(this).next().next().find("textarea").trigger("focus"); } }); $("#boiteindice .aide").off("click"); $("#boiteindice .aide").on("click", function(evt) { $("#aide").load("https://coursdesciences.fr/devoir/outils/aide_mathQuill.html"); $("#aide").dialog({ position: { my: "left center", at: "right top", of: this }, width: 410 }); $("#aide").dialog("open"); }); } $(".question").hide(); $("#page").parent().show(); });
    </script>
</div>
